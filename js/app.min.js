(function(){var GENDER,app,rand;GENDER={NONE:0,MALE:1,FEMALE:2};rand=function(min,max){var _ref;if(max==null){_ref=[min,0],max=_ref[0],min=_ref[1]}return Math.floor(Math.random()*(max-min+1))+min};app=new Triangle("TriangleDemo");app.factory("MainFactory",{collections:{rooms:{name:"",genderRestrict:GENDER.NONE,ageLimit:0},people:{roomId:null,name:"",gender:GENDER.MALE,age:0,$edit:false}},onAddPeople:function(man){if(!man.age){man.age=rand(1,80)}if(!man.gender){man.gender=rand(1)?GENDER.MALE:GENDER.FEMALE}if(!man.age){return man.name=(man.gender===GENDER.MALE?"Male":"Female")+(" "+rand(100,999))}},onAddRoom:function(room){if(!room.name){return room.name="Room #"+rand(100,999)}},init:function(){this.people.on(Triangle.EVENT.ADD,this.onAddPeople);this.rooms.on(Triangle.EVENT.ADD,this.onAddRoom);return this.rooms.setChildCollection({collection:"people",name:"people",bind:{id:"roomId"},separator:function(man){return man.age<=this.ageLimit&&(this.genderRestrict===GENDER.NONE||man.gender===this.genderRestrict)}})}});app.controller("MainController",{inject:"MainFactory as model",scope:{rooms:"model",people:"model"}});app.directive("room",{restrict:Triangle.DIRECTIVE_TYPE.ELEMENT,templateUrl:"jsRoomTemplate",transclude:true,scope:{room:"=",removable:"="},local:{scope:{room:"Scope"}},link:function(){return console.log(this.room,this.$scope.room,this.$scope.removable!=null)}})}).call(this);